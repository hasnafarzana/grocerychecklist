<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monthly Grocery Checklist</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f7f7; padding:20px; }
    .container{ max-width:750px; margin:auto; background:white; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1);} 
    h1{ text-align:center;}
    .list-actions{ display:flex; gap:10px; flex-wrap:wrap; }

    /* FIXED: mobile overflow + delete alignment */
    .item{ 
      margin:6px 0; 
      padding:8px; 
      background:#fafafa; 
      border-radius:6px; 
      display:flex; 
      align-items:flex-start; 
      gap:10px; 
      border:1px solid #ddd; 
      width:100%;
      box-sizing:border-box;
    }

    .item textarea{
      flex:1;
      padding:6px 8px;
      border-radius:6px;
      border:1px solid #ccc;
      background:white;
      font-size:14px;
      resize:none;
      overflow:hidden; /* auto height */
      min-height:36px;
      line-height:1.4;
      width:100%;
    }

    button{ padding:10px 15px; border:none; background:#4CAF50; color:white; border-radius:6px; cursor:pointer; font-size:14px; white-space:nowrap; }
    button.secondary{ background:#2196F3 }
    button.ghost{ background:#666; }
    button.delete{
      background:#e53935;
      padding:6px 10px;
      border-radius:6px;
      font-size:12px;
      margin-left:auto; /* keeps delete to right */
    }
    button:hover{ filter:brightness(0.9); }
    .footer-text{ text-align:center; margin-top:15px; font-size:13px; color:#666; }

    @media(max-width:600px){
      .item{ gap:8px; }
      button.delete{ font-size:11px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Monthly Grocery Checklist</h1>

    <div id="list"></div>

    <br>
    <div class="list-actions">
      <button onclick="copySelected()">Copy Selected Items</button>
      <button class="secondary" onclick="sendToWhatsApp()">Send to WhatsApp</button>
      <button class="ghost" onclick="addNewItem()">Add New Item</button>
    </div>

    <p class="footer-text">Edit items freely â†’ select â†’ Copy or Send to WhatsApp âœ¨</p>
  </div>

  <script>
    let items = [
      "Karnataka ponni - 3kg",
      "Basmati - 2kg",
      "Sugar - 1kg",
      "Anil semiya white - 2",
      "Aashirvad aata - 1/2 (2-packets)",
      "Vim bar soap small - 10",
      "Harpic blue - 1",
      "Harpic red - 1",
      "Bathroom flush - 2 packs",
      "Garbage bag - small - 2, big - 2",
      "Lyzol - green - 1",
      "Fab liquid - 2 litre",
      "Sakthi manjal thool - 50gm",
      "Sakthi milagu thool - 50gm",
      "Sakthi Garam masala - 50gm",
      "Vellai sundal - 500gm",
      "Poondu - 250gm",
	  "Vermicili- 2 packets",
	  "Anil semiya white - 2",
	  "Gold winner - 1 liter - 1 packet ",
	  "Tata salt - 1 packet",
	  "Naga ravai - 1/2kg",
	  "Thovaram parupu - 1",
	  "Bru coffee - 100g",
	  "3 roses - 250g"
    ];

    const listContainer = document.getElementById("list");

    function autoResize(el){
      el.style.height = 'auto';
      el.style.height = el.scrollHeight + 'px';
    }

    function render(){
      listContainer.innerHTML = "";
      items.forEach((text, index) => {
        const div = document.createElement("div");
        div.className = "item";

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = "item" + index;

        const textarea = document.createElement("textarea");
        textarea.value = text;
        textarea.className = "item-text";
        autoResize(textarea);
        textarea.addEventListener('input', (e) => {
          items[index] = textarea.value;
          autoResize(textarea);
        });

        const delBtn = document.createElement('button');
        delBtn.textContent = 'Delete';
        delBtn.className = 'delete';
        delBtn.onclick = () => {
          items.splice(index,1);
          render();
        };

        div.appendChild(checkbox);
        div.appendChild(textarea);
        div.appendChild(delBtn);
        listContainer.appendChild(div);
      });
    }

    render();

    async function safeCopy(text) {
      try {
        await navigator.clipboard.writeText(text);
        alert("Copied to clipboard! Paste in WhatsApp ðŸ‘");
      } catch (err) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.select();
        try {
          const ok = document.execCommand('copy');
          if (ok) alert('Copied using fallback! Paste in WhatsApp ðŸ‘');
          else alert('Copy failed. Please longâ€‘press & copy manually.');
        } finally {
          document.body.removeChild(textarea);
        }
      }
    }

    function getSelectedItems(){
      const selected = [];
      document.querySelectorAll('#list .item').forEach((row) => {
        const box = row.querySelector('input[type=checkbox]');
        const text = row.querySelector('.item-text').value.trim();
        if (box.checked && text) selected.push(text);
      });
      return selected;
    }

    function copySelected(){
      const selected = getSelectedItems();
      if (!selected.length){
        alert("Please select at least one item");
        return;
      }
      safeCopy(selected.join("\n"));
    }

    function sendToWhatsApp(){
      const selected = getSelectedItems();
      if (!selected.length){
        alert("Please select at least one item");
        return;
      }

      const message = encodeURIComponent(selected.join("\n"));

      const webUrl = `https://api.whatsapp.com/send?text=${message}`;
      const mobileUrl = `whatsapp://send?text=${message}`;

      try {
        window.open(webUrl, '_blank');
      } catch(e){
        window.location.href = mobileUrl;
      }
    }

    function addNewItem(){
      items.push("");
      render();
    }
  </script>
</body>
</html>
